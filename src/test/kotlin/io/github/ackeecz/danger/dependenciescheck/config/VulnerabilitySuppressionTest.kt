package io.github.ackeecz.danger.dependenciescheck.config

import io.kotest.assertions.throwables.shouldThrow
import io.kotest.core.spec.style.FunSpec
import io.kotest.matchers.shouldBe

internal class VulnerabilitySuppressionTest : FunSpec({

    test("construct correct fully qualified name from group ID and artifact ID") {
        val groupId = "com.squareup.retrofit2"
        val artifactId = "retrofit"

        val underTest = VulnerabilitySuppression(
            groupId = groupId,
            artifactId = artifactId,
            listOf(element = "CVE-2018-1000850"),
        )

        underTest.fullyQualifiedName shouldBe "$groupId:$artifactId"
    }

    test("throw exception if instance created with empty list of vulnerabilities") {
        shouldThrow<IllegalArgumentException> {
            VulnerabilitySuppression(
                groupId = "",
                artifactId = "",
                vulnerabilities = emptyList(),
            )
        }
    }
})
